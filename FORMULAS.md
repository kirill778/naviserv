# Формулы в CSV Data Processor

Этот документ содержит подробную информацию о работе с формулами в CSV Data Processor.

## Содержание

- [Основные принципы](#основные-принципы)
- [Синтаксис формул](#синтаксис-формул)
- [Доступные функции](#доступные-функции)
- [Использование диапазонов ячеек](#использование-диапазонов-ячеек)
- [Примеры использования](#примеры-использования)
- [Руководство по интерфейсу](#руководство-по-интерфейсу)
- [Устранение неполадок](#устранение-неполадок)

## Основные принципы

Функциональность формул в CSV Data Processor похожа на аналогичную функциональность в Microsoft Excel или Google Sheets:

- Формулы всегда начинаются со знака равенства (`=`)
- Формулы могут содержать ссылки на ячейки (например, `A1`, `B2`, `AA25`)
- Ссылки на ячейки автоматически обновляются при изменении значений в этих ячейках
- Поддерживаются математические операторы и базовые функции

## Синтаксис формул

### Математические операторы

- `+` (сложение)
- `-` (вычитание)
- `*` (умножение)
- `/` (деление)
- `()` (скобки для приоритета операций)

### Ссылки на ячейки

- Одиночные ячейки: `A1`, `B2`, `Z10`
- Диапазоны ячеек: `A1:A5`, `B2:D4`

### Примеры формул

- `=A1+B1` (сложение значений из ячеек A1 и B1)
- `=(A1+B1)*C1` (сложение A1 и B1, затем умножение на C1)
- `=A1+5` (сложение значения из A1 и числа 5)
- `=SUM(A1:A10)` (сумма всех значений в диапазоне от A1 до A10)

## Доступные функции

### Математические функции

- `SUM(ячейка1; [ячейка2]; ...)` или `SUM(диапазон)` - суммирует все числа в указанных ячейках или диапазоне
  - Пример: `=SUM(A1:A5)` или `=SUM(A1;B1;C1)`

### Статистические функции

- `AVERAGE(ячейка1; [ячейка2]; ...)` или `AVERAGE(диапазон)` - вычисляет среднее арифметическое
- `MAX(ячейка1; [ячейка2]; ...)` или `MAX(диапазон)` - находит максимальное значение
- `MIN(ячейка1; [ячейка2]; ...)` или `MIN(диапазон)` - находит минимальное значение
- `COUNT(ячейка1; [ячейка2]; ...)` или `COUNT(диапазон)` - подсчитывает количество числовых значений

### Логические функции

- `IF(логическое_выражение; значение_если_истина; значение_если_ложь)` - возвращает одно значение, если указанное условие оценивается как ИСТИНА, и другое значение, если оно оценивается как ЛОЖЬ

### Текстовые функции

- `CONCATENATE(текст1; [текст2]; ...)` - объединяет несколько текстовых строк в одну

## Использование диапазонов ячеек

Диапазоны ячеек позволяют ссылаться на несколько ячеек одновременно, что особенно полезно при работе с функциями.

### Синтаксис диапазонов

Диапазон указывается двумя ссылками на ячейки, разделенными двоеточием (`:`) - указываются верхняя левая и нижняя правая ячейки прямоугольного диапазона.

Примеры:
- `A1:A5` - ячейки A1, A2, A3, A4, A5
- `A1:C3` - прямоугольник из 9 ячеек (3×3) от A1 до C3
- `B2:D2` - ячейки B2, C2, D2

### Использование диапазонов в функциях

Диапазоны ячеек особенно полезны с агрегатными функциями:

- `=SUM(A1:A10)` - суммирует значения всех ячеек в диапазоне
- `=AVERAGE(B1:B20)` - вычисляет среднее значение ячеек в диапазоне
- `=MAX(C1:C100)` - находит максимальное значение в диапазоне

## Примеры использования

### Пример 1: Суммирование списка чисел

1. Введите числа в ячейки A1, A2, A3 (например, 1, 2, 3)
2. В ячейку B1 введите формулу `=SUM(A1:A3)`
3. Результат будет 6 (1+2+3)

### Пример 2: Расчет среднего балла

1. Введите оценки в ячейки A1, A2, A3, A4, A5 (например, 4, 5, 3, 4, 5)
2. В ячейку B1 введите формулу `=AVERAGE(A1:A5)`
3. Результат будет 4.2 (среднее арифметическое оценок)

### Пример 3: Использование математических операций

1. В ячейку A1 введите число 10
2. В ячейку A2 введите число 5
3. В ячейку B1 введите формулу `=A1*A2+20`
4. Результат будет 70 (10×5+20)

## Руководство по интерфейсу

### Панель формул

В верхней части электронной таблицы находится панель формул, которая предоставляет:

- **Метка ячейки**: Показывает адрес текущей активной ячейки (например, A1)
- **Поле ввода**: Показывает и позволяет редактировать содержимое активной ячейки
- **Кнопка "fx"**: Открывает диалог выбора функции
- **Кнопка "+"**: Активирует режим выбора ячеек для формулы

### Использование диалога функций

1. Щелкните по ячейке, в которую хотите добавить формулу
2. Нажмите кнопку "fx" в панели формул
3. Выберите нужную функцию из списка
   - Можно отфильтровать функции по категории (Математические, Статистические, Логические и т.д.)
   - Можно воспользоваться поиском для быстрого нахождения нужной функции
   - При выборе функции отображается её описание и синтаксис
4. Функция будет вставлена в формулу, и курсор будет помещен внутри скобок
5. Введите аргументы функции или используйте выбор ячеек

Также можно использовать клавиатурную навигацию в диалоге функций:
- Клавиши ↑↓ (стрелки вверх/вниз) для перемещения по списку функций
- Enter для подтверждения выбора функции
- Esc для закрытия диалога без выбора функции

### Режим выбора ячеек для формулы

1. Начните ввод формулы с `=`
2. Поставьте курсор в место, куда нужно вставить ссылку на ячейку
3. Нажмите кнопку "+" в панели формул (или продолжайте ввод формулы)
4. Щелкните по ячейке, которую хотите добавить в формулу
5. Ссылка на ячейку будет вставлена в формулу

## Устранение неполадок

### Распространенные ошибки

- **#ERROR**: Формула содержит синтаксическую ошибку или ссылается на недоступные ячейки
- **Формула отображается как текст**: Убедитесь, что формула начинается со знака равенства (=)
- **Циклическая ссылка**: Формула не может ссылаться на ячейку, которая прямо или косвенно ссылается обратно на исходную ячейку

### Советы

- Используйте скобки для явного указания порядка операций
- При работе со сложными формулами разбивайте их на части, используя промежуточные ячейки
- Для отладки сложных формул используйте временное упрощение, чтобы найти проблемную часть 